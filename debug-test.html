<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒè¯•æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background: #e8f5e8; border-color: #4caf50; }
        .error { background: #ffebee; border-color: #f44336; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ğŸ”§ è°ƒè¯•æµ‹è¯•é¡µé¢</h1>
    
    <div class="test">
        <h3>1. é…ç½®æ£€æŸ¥</h3>
        <button onclick="checkConfig()">æ£€æŸ¥é…ç½®</button>
        <div id="configResult"></div>
    </div>

    <div class="test">
        <h3>2. FeishuAPIåˆå§‹åŒ–æµ‹è¯•</h3>
        <button onclick="testFeishuInit()">æµ‹è¯•FeishuAPIåˆå§‹åŒ–</button>
        <div id="feishuInitResult"></div>
    </div>

    <div class="test">
        <h3>3. TaskManageråˆå§‹åŒ–æµ‹è¯•</h3>
        <button onclick="testTaskManagerInit()">æµ‹è¯•TaskManageråˆå§‹åŒ–</button>
        <div id="taskManagerResult"></div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/feishu-api.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        function checkConfig() {
            const result = document.getElementById('configResult');
            try {
                console.log('CONFIGå¯¹è±¡:', CONFIG);
                
                const checks = [
                    { name: 'CONFIGå­˜åœ¨', value: typeof CONFIG !== 'undefined' },
                    { name: 'FEISHUé…ç½®å­˜åœ¨', value: CONFIG.FEISHU !== undefined },
                    { name: 'TOKEN_URLå­˜åœ¨', value: CONFIG.FEISHU.TOKEN_URL !== undefined },
                    { name: 'API_URLå­˜åœ¨', value: CONFIG.FEISHU.API_URL !== undefined },
                    { name: 'APP_IDå­˜åœ¨', value: CONFIG.FEISHU.APP_ID !== undefined },
                    { name: 'APP_SECRETå­˜åœ¨', value: CONFIG.FEISHU.APP_SECRET !== undefined },
                    { name: 'BITABLE_IDå­˜åœ¨', value: CONFIG.FEISHU.BITABLE_ID !== undefined },
                    { name: 'TABLE_IDå­˜åœ¨', value: CONFIG.FEISHU.TABLE_ID !== undefined },
                    { name: 'DOUBAOé…ç½®å­˜åœ¨', value: CONFIG.DOUBAO !== undefined }
                ];

                let html = '<ul>';
                let allPassed = true;
                
                checks.forEach(check => {
                    const status = check.value ? 'âœ…' : 'âŒ';
                    html += `<li>${status} ${check.name}: ${check.value}</li>`;
                    if (!check.value) allPassed = false;
                });
                
                html += '</ul>';
                html += `<p><strong>å½“å‰ç¯å¢ƒ:</strong> ${window.location.hostname}</p>`;
                html += `<p><strong>TOKEN_URL:</strong> ${CONFIG.FEISHU.TOKEN_URL}</p>`;
                html += `<p><strong>API_URL:</strong> ${CONFIG.FEISHU.API_URL}</p>`;
                
                result.innerHTML = html;
                result.parentElement.className = allPassed ? 'test success' : 'test error';
                
            } catch (error) {
                result.innerHTML = `âŒ é…ç½®æ£€æŸ¥å¤±è´¥: ${error.message}`;
                result.parentElement.className = 'test error';
            }
        }

        function testFeishuInit() {
            const result = document.getElementById('feishuInitResult');
            try {
                const feishuAPI = new FeishuAPI();
                result.innerHTML = `âœ… FeishuAPIåˆå§‹åŒ–æˆåŠŸ<br>isNetlify: ${feishuAPI.isNetlify}`;
                result.parentElement.className = 'test success';
            } catch (error) {
                result.innerHTML = `âŒ FeishuAPIåˆå§‹åŒ–å¤±è´¥: ${error.message}<br>å †æ ˆ: ${error.stack}`;
                result.parentElement.className = 'test error';
            }
        }

        function testTaskManagerInit() {
            const result = document.getElementById('taskManagerResult');
            try {
                const taskManager = new TaskManager();
                result.innerHTML = `âœ… TaskManageråˆå§‹åŒ–æˆåŠŸ`;
                result.parentElement.className = 'test success';
            } catch (error) {
                result.innerHTML = `âŒ TaskManageråˆå§‹åŒ–å¤±è´¥: ${error.message}<br>å †æ ˆ: ${error.stack}`;
                result.parentElement.className = 'test error';
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥é…ç½®
        window.addEventListener('load', () => {
            checkConfig();
        });
    </script>
</body>
</html>
